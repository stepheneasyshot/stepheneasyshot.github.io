---
layout: post
description: > 
  本文介绍了在AOSP项目源码上进行预制系统组件的流程，包含C程序，jar包，系统apk预制，三方apk预制
image: 
  path: /assets/img/blog/blogs_aosp.png
  srcset: 
    1920w: /assets/img/blog/blogs_aosp.png
    960w:  /assets/img/blog/blogs_aosp.png
    480w:  /assets/img/blog/blogs_aosp.png
accent_image: /assets/img/blog/blogs_aosp.png
excerpt_separator: <!--more-->
sitemap: false
---
# [ AOSP ] 预制系统组件
## 源码分区
ARM + Android 行业流程与 Android 常用的四个分区：
* System 分区
* Vender 分区
* Odm 分区
* Product 分区
ARM + Android 这个行业，一个简化的普遍流程：
1. Google 开发迭代 AOSP + Kernel
芯片厂商，针对自己的芯片特点，移植 AOSP 和 Kernel，使其可以在自己的芯片上跑起来。
2. 方案厂商（很多芯片厂商也扮演了方案厂商的角色），设计电路板，给芯片添加外设，在芯片厂商源码基础上开发外设相关软件，主要是驱动和 hal，改进性能和稳定性。
3. 产品厂商，主要是系统软件开发，UI 定制以及硬件上的定制(添加自己的外设)，改进性能和稳定性.
Google 开发的通用 Android 系统组件编译后会被存放到 System 分区，原则上不同厂商、不同型号的设备都通用。

芯片厂商和方案厂商针对硬件相关的平台通用的可执行程序、库、系统服务和 app 等一般放到 Vender 分区。（开发的驱动程序是放在 boot 分区的 kernel 部分）

到了产品厂商这里，情况稍微复杂一点，通常针对同一套软硬件平台，可能会开发多个产品。比如：小米 12s，小米12s pro，小米12s ultra 均源于骁龙8+平台。
每一个产品，我们称之为一个 Variant（变体）。

通常情况下，做产品的厂商在同一个硬件平台上针对不同的产品会从硬件和软件两个维度来做定制。

硬件上，产品 A 可能用的是京东方的屏，产品 B 可能用的是三星的屏；差异硬件相关的软件部分都会放在 Odm 分区。这样，产品 A 和产品 B 之间 Odm 以外的分区都是一样的，便于统一维护与升级。(硬件相关的软件共用部分放在 vendor 分区)

软件上，产品 A 可能是带广告的版本，产品 B 可能是不带广告的版本。这些有差异的软件部分都放在 Product 分区，这样产品 A 和产品 B 之间 Product 以外的分区都是一样的，便于统一维护与升级。(软件共用部分都放在 System分区)

总结一下，不同产品之间公共的部分放在 System 和 Vender 分区，差异的部分放在 Odm 和 Product 分区。
## Product配置

## 集成C程序

## 集成Java可执行程序

## apk的方式集成系统app

## 源码方式集成系统app

## 三方app集成

