<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Android常用调试命令 | Stephen&#39;s Personal Page</title>
<meta name="description" content="在行中知，在知中行" />
<link rel="shortcut icon" href="https://github.com/stepheneasyshot/stepheneasyshot.github.io/favicon.ico">
<link rel="stylesheet" href="https://github.com/stepheneasyshot/stepheneasyshot.github.io/styles/main.css">

<script src="https://github.com/stepheneasyshot/stepheneasyshot.github.io/media/js/jquery.min.js"></script>
<script src="https://github.com/stepheneasyshot/stepheneasyshot.github.io/media/js/masonry.pkgd.min.js"></script>
<script src="https://github.com/stepheneasyshot/stepheneasyshot.github.io/media/js/aos.js"></script>
<script src="https://github.com/stepheneasyshot/stepheneasyshot.github.io/media/js/pace.min.js"></script>
<script src="https://github.com/stepheneasyshot/stepheneasyshot.github.io/media/js/view-image.min.js"></script>
<script src="https://github.com/stepheneasyshot/stepheneasyshot.github.io/media/js/jquery.magnific-popup.min.js"></script>
<script src="https://github.com/stepheneasyshot/stepheneasyshot.github.io/media/js/functions.js"></script>
    <meta name="referrer" content="never">
    <meta name="description" content="Windows常用命令
目录跳转相关
cd \  跳转当前盘根目录
cd users/8888/Desktop  跳转当前盘内的某个文件夹目录
cd /d E:Software  使用/d参数跳转其他盘的某个文件夹
cd /?  获取命令帮..." />
    <meta name="keywords" content="Android" />
    <script src="https://github.com/stepheneasyshot/stepheneasyshot.github.io/media/js/waterfall.min.js"></script>
    <script src="https://github.com/stepheneasyshot/stepheneasyshot.github.io/media/js/prism.min.js"></script>
  </head>
  <body>
            <header id="header" class="grid-container">
        <!-- start: .menu-wrapper -->
        <div class="menu-mobile"> 
          <i class="fa fa-reorder"></i>
        </div>
        <div class="menu-wrapper">
          <div class="">
            <div class="logo">
              <a href="https://github.com/stepheneasyshot/stepheneasyshot.github.io"><img src="/media/images/logoo.png" alt=""></a>
            </div>
            <!-- start: .main-nav -->

            <nav class="main-nav grid-container grid-parent">
              <ul id="menu-header" class="menu gradient-effect">
                <li class=""><a href="https://github.com/stepheneasyshot/stepheneasyshot.github.io" class="menu">首页</a></li>
                
                  <li class="" >
                    <a href="/" class="menu">
                      首页
                    </a>
                  </li>
                
                  <li class="" >
                    <a href="/archives" class="menu">
                      归档
                    </a>
                  </li>
                
                  <li class="" >
                    <a href="/tags" class="menu">
                      标签
                    </a>
                  </li>
                
                  <li class="" >
                    <a href="/post/about" class="menu">
                      关于
                    </a>
                  </li>
                
                <li class="search-menu-item hide-on-mobile hide-on-tablet"><a href="#search-lightbox" class="lightbox mfp-inline"><i class="fa fa-search-line"></i></a></li>
              </ul>
            </nav>
            <a href="#search-lightbox" class="lightbox epcl-search-button mfp-inline hide-on-tablet hide-on-desktop"><i class="fa fa-search-line"></i></a>
            <!-- end: .main-nav -->
            <div class="clear"></div>
            <div class="border hide-on-tablet hide-on-mobile"></div>
          </div>    
          <div class="clear"></div>
        </div>
        <!-- end: .menu-wrapper -->
        <div class="clear"></div>
      </header>
      <div class="hide-on-mobile hide-on-tablet hide-on-desktop">
        <div id="search-lightbox" class="grid-container grid-small grid-parent mfp-hide">
          <div class="search-wrapper section">
            <form id="gridea-search-form" data-update="1735025099700" action="/search/index.html" class="search-form" _lpchecked="1">
              <input type="text" name="q" id="s" value="" class="search-field" placeholder="搜点啥..." aria-label="搜点啥..." required="">
              <button type="submit" class="submit" aria-label="Submit">
                <i class="fa fa-search-line"></i>
              </button>
            </form>
          </div>
        </div>
      </div>

      <main id="single" class="main grid-container fullcover no-sidebar aos-init aos-animate" data-aos="fade">

        <div class="center content">
          <div class="featured-image cover" style="background-image: url('https://github.com/stepheneasyshot/stepheneasyshot.github.io/post-images/android-chang-yong-diao-shi-ming-ling.jpg');">
            <div class="meta top"> 
              <time class="meta-info" style="float:left;" datetime="2024-06-06"><i class="fa fa-calendar"></i><span class="lately">7 个月前</span></time>
              
              <a href="https://github.com/stepheneasyshot/stepheneasyshot.github.io/post/android-chang-yong-diao-shi-ming-ling/#comments" class="comments meta-info" title="">
                <i class="fa fa-comment remixicon"></i><span class="comment-count valine-comment-count" data-xid="/android-chang-yong-diao-shi-ming-ling/"> </span>
              </a>
              <span id="/android-chang-yong-diao-shi-ming-ling/" class="leancloud_visitors views-counter meta-info" title=""><i class="fa fa-leancloud remixicon"></i><span class="leancloud-visitors-count"></span></span>
              
            </div>
            <div class="info">
              <div class="tags ">
                
                      <a href="https://github.com/stepheneasyshot/stepheneasyshot.github.io/tag/5yQtIxh3Hz/" class="ctag ctag-0 ctag-5yQtIxh3Hz" aria-label="">Android</a>
                    
              </div>
              <h1 class="title ularge white bold">Android常用调试命令</h1>
            </div>
          </div>
        </div>  

        <div class="epcl-page-wrapper">
          <div class="left-content grid-70 np-mobile">
            <article class="main-article post">
              <section class="post-content">
                <div class="text">
                  <h1 id="windows常用命令">Windows常用命令</h1>
<h2 id="目录跳转相关">目录跳转相关</h2>
<p>cd \  跳转当前盘根目录<br>
cd users/8888/Desktop  跳转当前盘内的某个文件夹目录<br>
cd /d E:Software  使用/d参数跳转其他盘的某个文件夹<br>
cd /?  获取命令帮助<br>
dir 相当于ls，查看当前目录下的子文件</p>
<h2 id="终止操作">终止操作</h2>
<p>某个任务卡住的情况下，直接使用<br>
Ctrl + C  结束等待</p>
<h2 id="清屏">清屏</h2>
<p>cls  清空当前屏幕上的内容<br>
注意清空后仍然可以使用上下键使用之前的命令</p>
<h2 id="重定向输出">重定向输出</h2>
<p>将原本输出到命令窗口的内容，转存到文件中，如jstack 12912 &gt;d:/s.txt 打印线程到指定文件。<br>
cmd &gt;   重定向输出并覆盖源文件。<br>
echo hello &gt; c:\1.txt       // 1.txt的文件内容先被清空，然后写入hello。<br>
cmd &gt;&gt;  重定向输出追加到文件末尾<br>
echo hello &gt;&gt;c:\1.txt      // 在1.txt文件末尾加上hello</p>
<h2 id="增删改查">增删改查</h2>
<p>md  derectoryName      创建文件夹<br>
rd derectoryName      删除文件夹<br>
copy 路径\文件名 路径\文件名 ：   把一个文件拷贝到另一个地方<br>
move 路径\文件名 路径\文件名 ：  把一个文件移动（就是剪切+复制）到另外一个地方<br>
del 文件名      //这个是专门删除文件的，不能删除文件夹</p>
<h2 id="网络调试">网络调试</h2>
<p>ping ip(主机名)    //用来测试某个网络是否畅通</p>
<h1 id="linux通用命令">Linux通用命令</h1>
<h2 id="ls">ls</h2>
<p>列出当前工作目录下的所有文件/文件夹的名称。可以增加路径，查看制定目录下的文件。<br>
参数：<br>
• -l：表示list，表示以详细列表的形式进行展示。另外-lh可以以可读性较好的形式来展示；<br>
• -a：表示显示所有的文件/文件夹（包含了隐藏文件/文件夹）</p>
<h2 id="pwd">pwd</h2>
<p>获取当前所处的目录</p>
<h2 id="cd">cd</h2>
<p>切换目录。<br>
cd ..  返回到父目录<br>
cd 绝对路径  可以从任意目录跳转，例如在system文件夹，cd /sdcard可以跳转到根目录的sdcard下面</p>
<h2 id="cp">cp</h2>
<p>复制文件。cp 路径/文件名  路径/[文件名]</p>
<h2 id="mv">mv</h2>
<p>移动文件夹，用法同cp</p>
<h2 id="rm">rm</h2>
<p>删除文件，rm 文件名<br>
参数：<br>
• -f：force，强制删除，不提示是否删除<br>
• -r：表示递归<br>
-r表示递归删除，把子目录里的文件全部删除，才能删除目标目录<br>
强删文件夹：rm -rf 文件夹名<br>
##cat<br>
打开一个文件，展示文件内容</p>
<h2 id="重定向输出-2">重定向输出</h2>
<p>这里和上文windows类似，将原来在窗口中输出的内容，输出到文件中，且若此文件不存在，会自动创建一个。<br>
输出内容写入 &gt; 擦除源文件内容，写新内容到文件<br>
输出内容追加 &gt;&gt; 输出追加文件末尾<br>
##mkdir<br>
mkdir dir创建文件夹</p>
<h2 id="touch">touch</h2>
<p>touch file创建文件<br>
注意可以同时创建多个文件，touch 123.txt  456.txt</p>
<h1 id="vim操作">Vim操作</h1>
<p>vim file 使用vim打开一个文件<br>
vim在android平台上其实是无法使用的，但是在桌面级或者服务器端都很重要，还是稍微记录一下。</p>
<h3 id="vim的模式">VIM的模式</h3>
<p>Vim共有以下6种常见的模式：</p>
<ul>
<li>普通模式（Normal mode）： 这是使用Vim打开一个文件时，Vim的默认模式。在普通模式下，您可以使用各种命令来移动光标、删除、复制、粘贴和其他编辑操作。</li>
<li>插入模式（Insert mode）： 在插入模式下，您可以像在其他文本编辑器中一样输入和编辑文本。按下键盘上的插入键（通常是 i 、a、o或 Insert 键）即可进入插入模式。编辑完成后，使用esc退出插入模式，输入:加字母表示退出，:q是退出，:w是保存，:wq是保存后退出，:q!表示强行退出。</li>
<li>可视模式（Visual mode）： 可视模式允许您选择、高亮并操作文本块。您可以使用各种移动命令来选择文本。在普通模式下敲击键盘的 v 键即可进入可视模式，然后移动光标就可以选中一块文本，常用来完成文本的复制、粘贴、删除等操作。</li>
<li>替换模式（Replace mode）： 在替换模式下，您可以直接替换光标所在位置的字符。在普通模式下敲击键盘上的 R 键即可进入替换模式。</li>
<li>命令行模式（Command-line mode）： 命令行模式允许您执行各种命令。您可以在命令行中输入命令，例如保存文件、退出Vim、显示行号等。在普通模式下敲击 : 键即可进入命令行模式。</li>
<li>Ex 模式（Ex mode）： Ex 模式是Vim的可选模式，它是命令行模式的扩展。Ex 模式提供了更多高级命令和编辑选项。可以一次执行多个命令。<br>
Vim的各种工作模式可以通过不同的键进行切换，均需使用Esc键返回到普通模式。一般大多数情况使用普通和插入模式即可。</li>
</ul>
<h1 id="adb操作">ADB操作</h1>
<p>核心内容。<br>
Windows段，shell外部的操作一般有：</p>
<h2 id="adb-devices">adb devices</h2>
<p>查看当前连接上的所有可调试设备，包括AS的虚拟机。用来查看是否成功连接上设备。<br>
如有多个设备，在adb后使用-s serialnumber 参数来区分不同的设备.</p>
<h2 id="adb-shell">adb shell</h2>
<p>进入设备的shell命令行工具界面，Android版的terminal，这个打开的shell的权限一般和系统应用权限相同。指令集大多与linux相同。</p>
<h2 id="adb-root">adb root</h2>
<p>这个指令只适合装载userdebug版本或者eng版本的设备，使目前的调试终端具有root权限，可以更方便地调试设备，修改系统关键文件和环境。如果要恢复到非root状态，可以使用adb unroot。</p>
<h2 id="adb-remount">adb remount</h2>
<p>'adb remount' 的作用相当于 'adb shell mount -o rw,remount,rw /system'，重新挂载system分区，实现对system分区重新挂载，可以对里面的文件进行增删修改。</p>
<h2 id="adb-kill-server">adb kill-server</h2>
<p>终结当前的调试服务端。</p>
<h2 id="指定-adb-server-的网络端口">指定 adb server 的网络端口</h2>
<p>命令：<br>
adb -P <port> start-server<br>
默认端口为 5037。</p>
<h2 id="无线调试">无线调试</h2>
<p>首先电脑和手机需要连接上同一个局域网内.<br>
键入adb tcpip 5555 ，打开设备的一个端口5555.<br>
进入android shell里输入ifconfig，查看设备IPV4地址ipaddr.<br>
再断开有线连接，输入adb connect ipaddr:port，即可开启无线调试.</p>
<h2 id="投屏">投屏</h2>
<ul>
<li>可以使用最新版AS即可，自带投屏，Running Devices.</li>
<li>想要清晰度更高可以下载screen copy工具：<br>
https://github.com/Genymobile/scrcpy</li>
</ul>
<h1 id="adb-shell内操作">adb shell内操作</h1>
<h2 id="应用管理">应用管理</h2>
<h3 id="查看已安装应用">查看已安装应用</h3>
<pre><code>adb shell pm list packages [-f] [-d] [-e] [-s] [-3] [-i] [-u] [--user USER_ID] [FILTER]
</code></pre>
<p>无参数筛选就是所有应哟，上面的一众参数为：</p>
<ul>
<li>-f  显示应用关联的 apk 文件</li>
<li>-d  只显示 disabled 的应用</li>
<li>-e  只显示 enabled 的应用</li>
<li>-s  只显示系统应用</li>
<li>-3  只显示第三方应用</li>
<li>-i  显示应用的 installer</li>
<li>-u  包含已卸载应用</li>
<li>最后的过滤器表示包名包含 FILTER 字符串</li>
</ul>
<p>过滤器使用：</p>
<pre><code>比如要查看包名包含字符串 mazhuang 的应用列表，命令：
adb shell pm list packages mazhuang
当然也可以使用 grep 来过滤：
adb shell pm list packages | grep mazhuang
</code></pre>
<h3 id="安装应用">安装应用</h3>
<pre><code>adb install [-lrtsdg] &lt;path_to_apk&gt;
</code></pre>
<ul>
<li>-l 将应用安装到保护目录 /mnt/asec</li>
<li>-r 允许覆盖安装</li>
<li>-t 允许安装 AndroidManifest.xml 里 application 指定 android:testOnly=&quot;true&quot; 的应用</li>
<li>-s 将应用安装到 sdcard</li>
<li>-d 允许降级覆盖安装</li>
<li>-g 授予所有运行时权限</li>
<li>--abi abi-identifier  为特定 ABI 强制安装 apk，abi-identifier 可以是 armeabi-v7a、arm64-v8a、v86、x86_64 等。</li>
</ul>
<p>返回字段为Success表示安装成功。<br>
这个操作实际上分三步走的：</p>
<pre><code>1. push apk 文件到 /data/local/tmp。
2. 调用 pm install 安装。
3. 删除 /data/local/tmp 下的对应 apk 文件。
所以，必要的时候也可以根据这个步骤，手动分步执行安装过程。
</code></pre>
<h3 id="卸载应用">卸载应用</h3>
<pre><code>adb uninstall [-k] &lt;packagename&gt;
</code></pre>
<p>packagename表示应用的包名，-k 参数可选，表示卸载应用但保留数据和缓存目录。</p>
<ul>
<li>清除缓存：</li>
</ul>
<pre><code>adb shell pm clear &lt;packagename&gt;
&lt;packagename&gt; 表示应用名包，这条命令的效果相当于在设置里的应用信息界面点击了「清除缓存」和「清除数据」。
</code></pre>
<h3 id="查看前台activity和service">查看前台Activity和Service</h3>
<pre><code>adb shell dumpsys activity activities | grep mResumedActivity
输出示例：
mResumedActivity: ActivityRecord{8079d7e u0 com.cyanogenmod.trebuchet/com.android.launcher3.Launcher t42}
其中的 com.cyanogenmod.trebuchet/com.android.launcher3.Launcher 就是当前处于前台的 Activity。
在 Windows 下以上命令可能不可用，可以尝试 adb shell dumpsys activity activities | findstr mResumedActivity 或 adb shell &quot;dumpsys activity activities | grep mResumedActivity&quot;。

adb shell dumpsys activity services [&lt;packagename&gt;]
&lt;packagename&gt; 参数不是必须的，指定 &lt;packagename&gt; 表示查看与某个包名相关的 Services，不指定表示查看所有 Services。
&lt;packagename&gt; 不一定要给出完整的包名，比如运行 adb shell dumpsys activity services org.mazhuang，那么包名 org.mazhuang.demo1、org.mazhuang.demo2 和 org.mazhuang123 等相关的 Services 都会列出来。
</code></pre>
<h3 id="查看一个app的详细信息">查看一个app的详细信息</h3>
<pre><code>adb shell dumpsys package &lt;packagename&gt;
</code></pre>
<p>输出中包含很多信息，包括 Activity Resolver Table、Registered ContentProviders、包名、userId、安装后的文件资源代码等路径、版本信息、权限信息和授予状态、签名版本信息等。</p>
<ul>
<li>只查看安装路径</li>
</ul>
<pre><code>adb shell pm path &lt;PACKAGE&gt;
</code></pre>
<h2 id="应用交互">应用交互</h2>
<h3 id="拉起activity">拉起Activity</h3>
<pre><code>adb shell am start [options] &lt;INTENT&gt;
一般使用-n参数指定一个具体的Activity。
例如：
adb shell am start -n org.mazhuang.boottimemeasure/.MainActivity
</code></pre>
<p>还可以不指定Activity，只指定包名，默认开启MainActivity:</p>
<pre><code>adb shell monkey -p &lt;packagename&gt; -c android.intent.category.LAUNCHER 1
</code></pre>
<h3 id="拉起服务service">拉起服务Service</h3>
<pre><code>adb shell am startservice [options] &lt;INTENT&gt;
例如：
adb shell am startservice -n com.tencent.mm/.plugin.accountsync.model.AccountAuthenticatorService
表示调起微信的某 Service。
</code></pre>
<ul>
<li>相应有停止服务：</li>
</ul>
<pre><code>adb shell am stopservice [options] &lt;INTENT&gt;
</code></pre>
<h3 id="发送广播">发送广播</h3>
<pre><code>adb shell am broadcast [options] &lt;INTENT&gt;
例如，向所有组件广播 BOOT_COMPLETED：
adb shell am broadcast -a android.intent.action.BOOT_COMPLETED
又例如，只向 org.mazhuang.boottimemeasure/.BootCompletedReceiver 广播 BOOT_COMPLETED：
adb shell am broadcast -a android.intent.action.BOOT_COMPLETED -n org.mazhuang.boottimemeasure/.BootCompletedReceiver
</code></pre>
<p>这类用法在测试的时候很实用，比如某个广播的场景很难制造，可以考虑通过这种方式来发送广播。<br>
既能发送系统预定义的广播，也能发送自定义广播。如下是部分系统预定义广播及正常触发时机：</p>
<ul>
<li>android.net.conn.CONNECTIVITY_CHANGE  网络连接发生变化</li>
<li>android.intent.action.SCREEN_ON  屏幕点亮</li>
<li>android.intent.action.SCREEN_OFF  屏幕熄灭</li>
<li>android.intent.action.BATTERY_LOW  电量低，会弹出电量低提示框</li>
<li>android.intent.action.DREAMING_STARTED  系统开始休眠</li>
<li>android.intent.action.DREAMING_STOPPED  系统停止休眠</li>
<li>android.intent.action.WALLPAPER_CHANGED  壁纸发生变化</li>
<li>android.intent.action.MEDIA_UNMOUNTED卸载外部介质</li>
<li>android.intent.action.MEDIA_MOUNTED挂载外部介质</li>
<li>android.os.action.POWER_SAVE_MODE_CHANGED省电模式开启</li>
</ul>
<h3 id="强制停止应用">强制停止应用</h3>
<pre><code>命令：
adb shell am force-stop &lt;packagename&gt;
命令示例：
adb shell am force-stop com.qihoo360.mobilesafe
表示停止 360 安全卫士的一切进程与服务。
</code></pre>
<h3 id="收紧内存">收紧内存</h3>
<pre><code>命令：
adb shell am send-trim-memory  &lt;pid&gt; &lt;level&gt;
pid: 进程 ID
level:
HIDDEN、RUNNING_MODERATE、BACKGROUND、
RUNNING_LOW、MODERATE、RUNNING_CRITICAL、COMPLETE
命令示例：
adb shell am send-trim-memory 12345 RUNNING_LOW
表示向 pid=12345 的进程，发出 level=RUNNING_LOW 的收紧内存命令。
</code></pre>
<h2 id="电脑和设备互传文件">电脑和设备互传文件</h2>
<pre><code>拉取设备里的文件
adb pull &lt;设备里的文件路径&gt; [电脑上的目录]
其中 电脑上的目录 参数可以省略，默认复制到当前目录。
例：
adb pull /sdcard/sr.mp4 ~/tmp/

往设备里推送文件

adb push &lt;电脑上的文件路径&gt; &lt;设备里的目录&gt;
例：
adb push ~/sr.mp4 /sdcard/
</code></pre>
<h2 id="模拟按键输入">模拟按键输入</h2>
<pre><code>adb shell input [&lt;source&gt;] &lt;command&gt; [&lt;arg&gt;...]
</code></pre>
<p>比如使用 adb shell input keyevent <keycode> 命令，不同的 keycode 能实现不同的功能，完整的 keycode 列表详见 KeyEvent，摘引部分我觉得有意思的如下：</p>
<ul>
<li>3  HOME 键</li>
<li>4  返回键</li>
<li>5  打开拨号应用</li>
<li>6  挂断电话</li>
<li>24  增加音量</li>
<li>25  降低音量</li>
<li>26  电源键</li>
<li>27  拍照（需要在相机应用里）</li>
<li>64  打开浏览器</li>
<li>82  菜单键</li>
<li>85  播放/暂停</li>
<li>86  停止播放</li>
<li>87  播放下一首</li>
<li>88  播放上一首</li>
<li>122  移动光标到行首或列表顶部</li>
<li>123  移动光标到行末或列表底部</li>
<li>126  恢复播放</li>
<li>127  暂停播放</li>
<li>164  静音</li>
<li>176  打开系统设置</li>
<li>187  切换应用</li>
<li>207  打开联系人</li>
<li>208  打开日历</li>
<li>209  打开音乐</li>
<li>210  打开计算器</li>
<li>220  降低屏幕亮度</li>
<li>221  提高屏幕亮度</li>
<li>223  系统休眠</li>
<li>224  点亮屏幕</li>
<li>231  打开语音助手</li>
<li>276  如果没有 wakelock 则让系统休眠</li>
</ul>
<h3 id="模拟滑动">模拟滑动</h3>
<p>如果锁屏没有密码，是通过滑动手势解锁，那么可以通过 input swipe 来解锁。<br>
命令（参数以机型 Nexus 5，向上滑动手势解锁举例）：</p>
<pre><code>adb shell input swipe 300 1000 300 500
</code></pre>
<p>参数 300 1000 300 500 分别表示起始点x坐标 起始点y坐标 结束点x坐标 结束点y坐标。</p>
<h3 id="输入文本">输入文本</h3>
<p>在焦点处于某文本框时，可以通过 input 命令来输入文本。<br>
命令：</p>
<pre><code>adb shell input text hello
</code></pre>
<p>现在 hello 出现在文本框了。</p>
<h2 id="查看日志">查看日志</h2>
<p>Android 系统的日志分为两部分，底层的 Linux 内核日志输出到 /proc/kmsg，Android 的日志输出到 /dev/log。</p>
<h3 id="按级别过滤">按级别过滤</h3>
<pre><code>adb logcat *:W
会将 Warning、Error、Fatal 和 Silent 日志输出。
</code></pre>
<h3 id="按tag过滤">按tag过滤</h3>
<pre><code>&lt;filter-spec&gt; 可以由多个 &lt;tag&gt;[:priority] 组成。
比如，命令：
adb logcat ActivityManager:I MyApp:D *:S
表示输出 tag ActivityManager 的 Info 以上级别日志，输出 tag MyApp 的 Debug 以上级别日志，及其它 tag 的 Silent 级别日志（即屏蔽其它 tag 日志）。
</code></pre>
<h3 id="清空日志">清空日志</h3>
<pre><code>adb logcat -c
</code></pre>
<h2 id="查看设备信息">查看设备信息</h2>
<h3 id="型号">型号</h3>
<pre><code>adb shell getprop ro.product.model
</code></pre>
<p>输出示例：<br>
Nexus 5</p>
<h3 id="电池状况">电池状况</h3>
<pre><code>adb shell dumpsys battery
输出示例：
Current Battery Service state:
  AC powered: false  USB powered: true  Wireless powered: false  status: 2
  health: 2
  present: true  level: 44
  scale: 100
  voltage: 3872
  temperature: 280
  technology: Li-poly
其中 scale 代表最大电量，level 代表当前电量。上面的输出表示还剩下 44% 的电量。
</code></pre>
<h3 id="屏幕分辨率">屏幕分辨率</h3>
<p>命令：<br>
adb shell wm size<br>
输出示例：<br>
Physical size: 1080x1920<br>
该设备屏幕分辨率为 1080px * 1920px。<br>
如果使用命令修改过，那输出可能是：<br>
Physical size: 1080x1920<br>
Override size: 480x1024<br>
表明设备的屏幕分辨率原本是 1080px * 1920px，当前被修改为 480px * 1024px。</p>
<h3 id="屏幕密度">屏幕密度</h3>
<p>命令：<br>
adb shell wm density<br>
输出示例：<br>
Physical density: 420<br>
该设备屏幕密度为 420dpi。<br>
如果使用命令修改过，那输出可能是：<br>
Physical density: 480<br>
Override density: 160<br>
表明设备的屏幕密度原来是 480dpi，当前被修改为 160dpi。</p>
<h3 id="显示屏参数">显示屏参数</h3>
<p>命令：<br>
adb shell dumpsys window displays<br>
输出示例：<br>
WINDOW MANAGER DISPLAY CONTENTS (dumpsys window displays)<br>
Display: mDisplayId=0<br>
init=1080x1920 420dpi cur=1080x1920 app=1080x1794 rng=1080x1017-1810x1731<br>
deferred=false layoutNeeded=false<br>
其中 mDisplayId 为 显示屏编号，init 是初始分辨率和屏幕密度，app 的高度比 init 里的要小，表示屏幕底部有虚拟按键，高度为 1920 - 1794 = 126px 合 42dp。</p>
<h3 id="android-系统版本">Android 系统版本</h3>
<p>命令：<br>
adb shell getprop ro.build.version.release<br>
输出示例：<br>
5.0.2</p>
<h3 id="ip-地址">IP 地址</h3>
<p>每次想知道设备的 IP 地址的时候都得「设置」-「关于手机」-「状态信息」-「IP地址」很烦对不对？通过 adb 可以方便地查看。<br>
命令：<br>
adb shell ifconfig | grep Mask<br>
输出示例：<br>
inet addr:10.130.245.230  Mask:255.255.255.252<br>
inet addr:127.0.0.1  Mask:255.0.0.0<br>
那么 10.130.245.230 就是设备 IP 地址。<br>
在有的设备上这个命令没有输出，如果设备连着 WiFi，可以使用如下命令来查看局域网 IP：<br>
adb shell ifconfig wlan0<br>
输出示例：<br>
wlan0: ip 10.129.160.99 mask 255.255.240.0 flags [up broadcast running multicast]<br>
或<br>
wlan0     Link encap:UNSPEC<br>
inet addr:10.129.168.57  Bcast:10.129.175.255  Mask:255.255.240.0<br>
inet6 addr: fe80::66cc:2eff:fe68:b6b6/64 Scope: Link<br>
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br>
RX packets:496520 errors:0 dropped:0 overruns:0 frame:0<br>
TX packets:68215 errors:0 dropped:0 overruns:0 carrier:0<br>
collisions:0 txqueuelen:3000<br>
RX bytes:116266821 TX bytes:8311736<br>
如果以上命令仍然不能得到期望的信息，那可以试试以下命令（部分系统版本里可用）：<br>
adb shell netcfg<br>
可以看到网络连接名称、启用状态、IP 地址和 Mac 地址等信息。</p>
<h3 id="mac-地址">Mac 地址</h3>
<p>命令：<br>
adb shell cat /sys/class/net/wlan0/address<br>
输出示例：<br>
f8:a9:d0:17:42:4d<br>
这查看的是局域网 Mac 地址，移动网络或其它连接的信息可以通过前面的小节「IP 地址」里提到的 adb shell netcfg 命令来查看。</p>
<h3 id="cpu-信息">CPU 信息</h3>
<p>命令：<br>
adb shell cat /proc/cpuinfo<br>
输出示例：<br>
Processor       : ARMv7 Processor rev 0 (v7l)<br>
processor       : 0<br>
BogoMIPS        : 38.40<br>
processor       : 1<br>
BogoMIPS        : 38.40<br>
processor       : 2<br>
BogoMIPS        : 38.40<br>
processor       : 3<br>
BogoMIPS        : 38.40<br>
Features        : swp half thumb fastmult vfp edsp neon vfpv3 tls vfpv4 idiva idivt<br>
CPU implementer : 0x51<br>
CPU architecture: 7<br>
CPU variant     : 0x2<br>
CPU part        : 0x06f<br>
CPU revision    : 0<br>
Hardware        : Qualcomm MSM 8974 HAMMERHEAD (Flattened Device Tree)<br>
Revision        : 000b<br>
Serial          : 0000000000000000<br>
这是 Nexus 5 的 CPU 信息，我们从输出里可以看到使用的硬件是 Qualcomm MSM 8974，processor 的编号是 0 到 3，所以它是四核的，采用的架构是 ARMv7 Processor rev 0 (v71)。</p>
<h3 id="内存信息">内存信息</h3>
<p>命令：<br>
adb shell cat /proc/meminfo<br>
输出示例：<br>
MemTotal:        1027424 kB<br>
MemFree:          486564 kB<br>
Buffers:           15224 kB<br>
Cached:            72464 kB<br>
SwapCached:        24152 kB<br>
Active:           110572 kB<br>
Inactive:         259060 kB<br>
Active(anon):      79176 kB<br>
Inactive(anon):   207736 kB<br>
Active(file):      31396 kB<br>
Inactive(file):    51324 kB<br>
Unevictable:        3948 kB<br>
Mlocked:               0 kB<br>
HighTotal:        409600 kB<br>
HighFree:         132612 kB<br>
LowTotal:         617824 kB<br>
LowFree:          353952 kB<br>
SwapTotal:        262140 kB<br>
SwapFree:         207572 kB<br>
Dirty:                 0 kB<br>
Writeback:             0 kB<br>
AnonPages:        265324 kB<br>
Mapped:            47072 kB<br>
Shmem:              1020 kB<br>
Slab:              57372 kB<br>
SReclaimable:       7692 kB<br>
SUnreclaim:        49680 kB<br>
KernelStack:        4512 kB<br>
PageTables:         5912 kB<br>
NFS_Unstable:          0 kB<br>
Bounce:                0 kB<br>
WritebackTmp:          0 kB<br>
CommitLimit:      775852 kB<br>
Committed_AS:   13520632 kB<br>
VmallocTotal:     385024 kB<br>
VmallocUsed:       61004 kB<br>
VmallocChunk:     209668 kB<br>
其中，MemTotal 就是设备的总内存，MemFree 是当前空闲内存。</p>
<h3 id="硬件与系统属性">硬件与系统属性</h3>
<p>设备的更多硬件与系统属性可以通过如下命令查看：<br>
adb shell cat /system/build.prop<br>
这会输出很多信息，包括前面几个小节提到的「型号」和「Android 系统版本」等。<br>
输出里还包括一些其它有用的信息，它们也可通过 adb shell getprop &lt;属性名&gt; 命令单独查看，列举一部分属性如下：</p>
<ul>
<li>ro.build.version.sdk  SDK 版本<br>
ro.build.version.releaseAndroid 系统版本<br>
ro.build.version.security_patchAndroid 安全补丁程序级别<br>
ro.product.model型号<br>
ro.product.brand品牌<br>
ro.product.name设备名<br>
ro.product.board处理器型号<br>
ro.product.cpu.abilistCPU 支持的 abi 列表[节注一]<br>
persist.sys.isUsbOtgEnabled是否支持 OTG<br>
dalvik.vm.heapsize每个应用程序的内存上限<br>
ro.sf.lcd_density屏幕密度<br>
ro.build.id=GRI40版本ID<br>
ro.build.display.id=GRJ22版本号<br>
ro.build.version.incremental=eng.buildbot.20110619.060228版本增量<br>
ro.build.version.sdk=10sdk版本<br>
ro.build.version.codename=REL版本代号<br>
ro.build.version.release=2.3.4Android 2.3.4系統无需修改，也可改为3.0装装B<br>
ro.build.date=Sun Jun 19 06:02:58 UTC 2011制作者制作的时间，可修改2011年X月X日 某某某制作<br>
ro.build.date.utc=0<br>
ro.build.type=user<br>
ro.build.user=buildbot<br>
ro.build.host=bb1<br>
ro.build.tags=test-keys<br>
ro.product.model=HTC Wildfire<br>
HTC内部手机代号也就是手机名，改为你想改的名字<br>
ro.product.brand=htc_wwe<br>
手机品牌，改为中国山寨机<br>
ro.product.name=htc_buzz<br>
手机正式名称，改为你想改的名字<br>
ro.product.device=buzz<br>
采用的设备，改为China G8<br>
ro.product.board=buzz<br>
采用的处理器，改为China 800.8Ghz<br>
ro.product.cpu.abi=armeabi-v6j<br>
cpu的版本<br>
ro.product.cpu.abi2=armeabi<br>
cpu的品牌<br>
ro.product.manufacturer=HTC<br>
手机制造商，改为中国智造<br>
ro.product.locale.language=en<br>
手机默认语言，把en改为zh<br>
ro.product.locale.region=US<br>
地区语言，美国毛多呀美国，干掉US改为CN<br>
ro.wifi.channels=WIFI连接的渠道<br>
ro.board.platform=msm7k主板平台<br>
ro.build.product=buzz建立产品<br>
ro.build.description=passion-user 2.3.3 GRI40 102588 release-keys用户的KEY<br>
ro.build.fingerprint=google/passion/passion:2.3.3/GRI40/102588:user/release-keys机身码的啥玩意<br>
注一：<br>
一些小厂定制的 ROM 可能修改过 CPU 支持的 abi 列表的属性名，如果用 ro.product.cpu.abilist 属性名查找不到，可以这样试试：<br>
adb shell cat /system/build.prop | grep ro.product.cpu.abi<br>
示例输出：<br>
ro.product.cpu.abi=armeabi-v7a<br>
ro.product.cpu.abi2=armeabi<br>
查看/修改序列号<br>
查看命令：<br>
adb get-serialno<br>
或：<br>
adb shell getprop sys.serialno<br>
修改序列号：<br>
通常安卓系统正常流程需要修改 cmdline中的参数，可以通过命令查看cmdline参数：<br>
adb shell cat /proc/cmdline<br>
显示：<br>
storagemedia=emmc androidboot.mode=emmc androidboot.dtbo_idx=0 androidboot.slot_suffix= androidboot.serialno=9501a97c59fe092 console=ttyFIQ0 androidboot.baseband=N/A androidboot.wificountrycode=US androidboot.veritymode=enforcing androidboot.hardware=rk30board androidboot.console=ttyFIQ0 firmware_class.path=/vendor/etc/firmware init=/init rootwait ro init=/init root=PARTUUID=af01642c-9b84-11e8-9b2a-234eb5e198a0 loop.max_part=7 androidboot.selinux=permissive buildvariant=userdebug earlyprintk=uart8250,mmio32,0xff690000 swiotlb=1 kpti=0 bt_type=4</li>
</ul>
<h2 id="修改设置">修改设置</h2>
<p>注： 修改设置之后，运行恢复命令有可能显示仍然不太正常，可以运行 adb reboot 重启设备，或手动重启。<br>
修改设置的原理主要是通过 settings 命令修改 /data/data/com.android.providers.settings/databases/settings.db 里存放的设置值。</p>
<h3 id="分辨率">分辨率</h3>
<p>命令：<br>
adb shell wm size 480x1024<br>
表示将分辨率修改为 480px * 1024px。<br>
恢复原分辨率命令：<br>
adb shell wm size reset</p>
<h3 id="屏幕密度-2">屏幕密度</h3>
<p>命令：<br>
adb shell wm density 160<br>
表示将屏幕密度修改为 160dpi。<br>
恢复原屏幕密度命令：<br>
adb shell wm density reset</p>
<h3 id="显示区域">显示区域</h3>
<p>命令：<br>
adb shell wm overscan 0,0,0,200<br>
四个数字分别表示距离左、上、右、下边缘的留白像素，以上命令表示将屏幕底部 200px 留白。<br>
恢复原显示区域命令：<br>
adb shell wm overscan reset</p>
<h3 id="关闭-usb-调试模式">关闭 USB 调试模式</h3>
<p>命令：<br>
adb shell settings put global adb_enabled 0<br>
恢复：<br>
用命令恢复不了了，毕竟关闭了 USB 调试 adb 就连接不上 Android 设备了。<br>
去设备上手动恢复吧：「设置」-「开发者选项」-「Android 调试」。</p>
<h3 id="允许禁止访问非-sdk-api">允许/禁止访问非 SDK API</h3>
<p>允许访问非 SDK API：<br>
adb shell settings put global hidden_api_policy_pre_p_apps 1<br>
adb shell settings put global hidden_api_policy_p_apps 1<br>
禁止访问非 SDK API：<br>
adb shell settings delete global hidden_api_policy_pre_p_apps<br>
adb shell settings delete global hidden_api_policy_p_apps<br>
不需要设备获得 Root 权限。<br>
命令最后的数字的含义：<br>
0  禁止检测非 SDK 接口的调用。该情况下，日志记录功能被禁用，并且令 strict mode API，即 detectNonSdkApiUsage() 无效。不推荐。<br>
1  仅警告——允许访问所有非 SDK 接口，但保留日志中的警告信息，可继续使用 strick mode API。<br>
2  禁止调用深灰名单和黑名单中的接口。<br>
3  禁止调用黑名单中的接口，但允许调用深灰名单中的接口。</p>
<h2 id="实用功能">实用功能</h2>
<h3 id="屏幕截图">屏幕截图</h3>
<p>截图保存到电脑：</p>
<pre><code>adb exec-out screencap -p &gt; sc.png
如果 adb 版本较老，无法使用 exec-out 命令，这时候建议更新 adb 版本。无法更新的话可以使用以下麻烦点的办法：
先截图保存到设备里：
adb shell screencap -p /sdcard/sc.png
然后将 png 文件导出到电脑：
adb pull /sdcard/sc.png
</code></pre>
<p>可以使用 adb shell screencap -h 查看 screencap 命令的帮助信息，下面是两个有意义的参数:</p>
<ul>
<li>-p  指定保存文件为 png 格式</li>
<li>-d display-id  指定截图的显示屏编号（有多显示屏的情况下）<br>
实测如果指定文件名以 .png 结尾时可以省略 -p 参数；否则需要使用 -p 参数。如果不指定文件名，截图文件的内容将直接输出到 stdout。</li>
</ul>
<h3 id="录制屏幕">录制屏幕</h3>
<p>录制屏幕以 mp4 格式保存到 /sdcard：<br>
adb shell screenrecord /sdcard/filename.mp4<br>
需要停止时按 Ctrl-C，默认录制时间和最长录制时间都是 180 秒。<br>
如果需要导出到电脑：<br>
adb pull /sdcard/filename.mp4<br>
可以使用 adb shell screenrecord --help 查看 screenrecord 命令的帮助信息，下面是常见参数及含义：</p>
<ul>
<li>--size WIDTHxHEIGHT  视频的尺寸，比如 1280x720，默认是屏幕分辨率。</li>
<li>--bit-rate RATE  视频的比特率，默认是 4Mbps。</li>
<li>--time-limit TIME  录制时长，单位秒。</li>
<li>--verbose  输出更多信息。</li>
</ul>
<h2 id="重新挂载-system-分区为可写">重新挂载 system 分区为可写</h2>
<p>注：需要 root 权限。<br>
/system 分区默认挂载为只读，但有些操作比如给 Android 系统添加命令、删除自带应用等需要对 /system 进行写操作，所以需要重新挂载它为可读写。</p>
<pre><code>adb shell
su
</code></pre>
<ol>
<li>查看当前分区挂载情况。<br>
命令：<br>
mount<br>
输出示例：</li>
</ol>
<pre><code>rootfs / rootfs ro,relatime 0 0
tmpfs /dev tmpfs rw,seclabel,nosuid,relatime,mode=755 0 0
devpts /dev/pts devpts rw,seclabel,relatime,mode=600 0 0
proc /proc proc rw,relatime 0 0
sysfs /sys sysfs rw,seclabel,relatime 0 0
selinuxfs /sys/fs/selinux selinuxfs rw,relatime 0 0
debugfs /sys/kernel/debug debugfs rw,relatime 0 0
none /var tmpfs rw,seclabel,relatime,mode=770,gid=1000 0 0
none /acct cgroup rw,relatime,cpuacct 0 0
none /sys/fs/cgroup tmpfs rw,seclabel,relatime,mode=750,gid=1000 0 0
none /sys/fs/cgroup/memory cgroup rw,relatime,memory 0 0
tmpfs /mnt/asec tmpfs rw,seclabel,relatime,mode=755,gid=1000 0 0
tmpfs /mnt/obb tmpfs rw,seclabel,relatime,mode=755,gid=1000 0 0
none /dev/memcg cgroup rw,relatime,memory 0 0
none /dev/cpuctl cgroup rw,relatime,cpu 0 0
none /sys/fs/cgroup tmpfs rw,seclabel,relatime,mode=750,gid=1000 0 0
none /sys/fs/cgroup/memory cgroup rw,relatime,memory 0 0
none /sys/fs/cgroup/freezer cgroup rw,relatime,freezer 0 0
/dev/block/platform/msm_sdcc.1/by-name/system /system ext4 ro,seclabel,relatime,data=ordered 0 0
/dev/block/platform/msm_sdcc.1/by-name/userdata /data ext4 rw,seclabel,nosuid,nodev,relatime,noauto_da_alloc,data=ordered 0 0
/dev/block/platform/msm_sdcc.1/by-name/cache /cache ext4 rw,seclabel,nosuid,nodev,relatime,data=ordered 0 0
/dev/block/platform/msm_sdcc.1/by-name/persist /persist ext4 rw,seclabel,nosuid,nodev,relatime,data=ordered 0 0
/dev/block/platform/msm_sdcc.1/by-name/modem /firmware vfat ro,context=u:object_r:firmware_file:s0,relatime,uid=1000,gid=1000,fmask=0337,dmask=0227,codepage=cp437,iocharset=iso8859-1,shortname=lower,errors=remount-ro 0 0
/dev/fuse /mnt/shell/emulated fuse rw,nosuid,nodev,relatime,user_id=1023,group_id=1023,default_permissions,allow_other 0 0
/dev/fuse /mnt/shell/emulated/0 fuse rw,nosuid,nodev,relatime,user_id=1023,group_id=1023,default_permissions,allow_other 0 0
找到其中我们关注的带 /system 的那一行：
/dev/block/platform/msm_sdcc.1/by-name/system /system ext4 ro,seclabel,relatime,data=ordered 0 
</code></pre>
<h3 id="重新挂载">重新挂载。</h3>
<p>命令：</p>
<pre><code>mount -o remount,rw -t yaffs2 /dev/block/platform/msm_sdcc.1/by-name/system /system
</code></pre>
<p>这里的 /dev/block/platform/msm_sdcc.1/by-name/system 就是我们从上一步的输出里得到的文件路径。<br>
如果输出没有提示错误的话，操作就成功了，可以对 /system 下的文件为所欲为了。</p>
<h2 id="查看连接过的-wifi-密码">查看连接过的 WiFi 密码</h2>
<p>注：需要 root 权限。<br>
命令：</p>
<pre><code>adb shell
su
cat /data/misc/wifi/*.conf
</code></pre>
<p>输出示例：</p>
<pre><code>network={
	ssid=&quot;TP-LINK_9DFC&quot;	scan_ssid=1
	psk=&quot;123456789&quot;	key_mgmt=WPA-PSK
	group=CCMP TKIP
	auth_alg=OPEN
	sim_num=1
	priority=13893
}
network={
	ssid=&quot;TP-LINK_F11E&quot;	psk=&quot;987654321&quot;	key_mgmt=WPA-PSK
	sim_num=1
	priority=17293
}
</code></pre>
<p>ssid 即为我们在 WLAN 设置里看到的名称，psk 为密码，key_mgmt 为安全加密方式。<br>
如果 Android O 或以后，WiFi 密码保存的地址有变化，是在 WifiConfigStore.xml 里面<br>
adb shell<br>
su<br>
cat /data/misc/wifi/WifiConfigStore.xml<br>
输出格式：<br>
数据项较多，只需关注 ConfigKey（WiFi 名字）和 PreSharedKey（WiFi 密码）即可<br>
&lt;stringname=&quot;ConfigKey&quot;&gt;&quot;Wi-Fi&quot;WPA_PSK</string>&lt;stringname=&quot;PreSharedKey&quot;&gt;&quot;931907334&quot;</string></p>
<h2 id="设置系统日期和时间">设置系统日期和时间</h2>
<p>注：需要 root 权限。<br>
命令：</p>
<pre><code>adb shell
su
date -s 20160823.131500
</code></pre>
<p>表示将系统日期和时间更改为 2016 年 08 月 23 日 13 点 15 分 00 秒。</p>
<h2 id="使用-monkey-进行压力测试">使用 Monkey 进行压力测试</h2>
<p>Monkey 可以生成伪随机用户事件来模拟单击、触摸、手势等操作，可以对正在开发中的程序进行随机压力测试。<br>
简单用法：<br>
adb shell monkey -p <packagename> -v 500<br>
表示向 <packagename> 指定的应用程序发送 500 个伪随机事件。<br>
Monkey 的详细用法参考 官方文档。</p>
<h2 id="开启关闭-wifi">开启/关闭 WiFi</h2>
<p>注：需要 root 权限。<br>
有时需要控制设备的 WiFi 状态，可以用以下指令完成。<br>
开启 WiFi：<br>
adb root<br>
adb shell svc wifi enable<br>
关闭 WiFi：<br>
adb root<br>
adb shell svc wifi disable<br>
若执行成功，输出为空；若未取得 root 权限执行此命令，将执行失败，输出 Killed。</p>
<h2 id="刷机相关命令">刷机相关命令</h2>
<h3 id="重启到-recovery-模式">重启到 Recovery 模式</h3>
<p>命令：<br>
adb reboot recovery<br>
从 Recovery 重启到 Android<br>
命令：<br>
adb reboot</p>
<h3 id="重启到-fastboot-模式">重启到 Fastboot 模式</h3>
<p>命令：<br>
adb reboot bootloader<br>
通过 sideload 更新系统<br>
如果我们下载了 Android 设备对应的系统更新包到电脑上，那么也可以通过 adb 来完成更新。<br>
以 Recovery 模式下更新为例：</p>
<ol>
<li>重启到 Recovery 模式。<br>
命令：adb reboot recovery</li>
<li>在设备的 Recovery 界面上操作进入 Apply update-Apply from ADB。<br>
注：不同的 Recovery 菜单可能与此有差异，有的是一级菜单就有 Apply update from ADB。</li>
<li>通过 adb 上传和更新系统。<br>
命令：</li>
</ol>
<pre><code>adb sideload &lt;path-to-update.zip&gt;
</code></pre>
<h2 id="安全相关命令">安全相关命令</h2>
<h3 id="启用禁用-selinux">启用/禁用 SELinux</h3>
<p>启用 SELinux<br>
adb root<br>
adb shell setenforce 1<br>
禁用 SELinux<br>
adb root<br>
adb shell setenforce 0</p>
<h3 id="启用禁用-dm_verity">启用/禁用 dm_verity</h3>
<p>启用 dm_verity<br>
adb root<br>
adb enable-verity<br>
禁用 dm_verity<br>
adb root<br>
adb disable-verity</p>
<h2 id="系统管理命令">系统管理命令</h2>
<p>Android 系统是基于 Linux 内核的，所以 Linux 里的很多命令在 Android 里也有相同或类似的实现，在 adb shell 里可以调用。本文档前面的部分内容已经用到了 adb shell 命令。<br>
###查看进程<br>
命令：</p>
<pre><code>adb shell ps
</code></pre>
<p>输出示例：</p>
<pre><code>USER     PID   PPID  VSIZE  RSS     WCHAN    PC        NAME
root      1     0     8904   788   ffffffff 00000000 S /init
root      2     0     0      0     ffffffff 00000000 S kthreadd
...
u0_a71    7779  5926  1538748 48896 ffffffff 00000000 S com.sohu.inputmethod.sogou:classic
u0_a58    7963  5926  1561916 59568 ffffffff 00000000 S org.mazhuang.boottimemeasure
...
shell     8750  217   10640  740   00000000 b6f28340 R ps
</code></pre>
<p>各列含义：<br>
USER所属用户<br>
PID进程 ID<br>
PPID父进程 ID<br>
NAME进程名</p>
<h3 id="查看实时资源占用情况">查看实时资源占用情况</h3>
<p>命令：</p>
<pre><code>adb shell top
</code></pre>
<p>输出示例：</p>
<pre><code>User 0%, System 6%, IOW 0%, IRQ 0%
User 3 + Nice 0 + Sys 21 + Idle 280 + IOW 0 + IRQ 0 + SIRQ 3 = 307
  PID PR CPU% S  #THR     VSS     RSS PCY UID      Name 8763  0   3% R     1  10640K   1064K  fg shell    top
  131  0   3% S     1      0K      0K  fg root     dhd_dpc
 6144  0   0% S   115 1682004K 115916K  fg system   system_server
  132  0   0% S     1      0K      0K  fg root     dhd_rxf
 1731  0   0% S     6  20288K    788K  fg root     /system/bin/mpdecision
  217  0   0% S     6  18008K    356K  fg shell    /sbin/adbd
 ...
 7779  2   0% S    19 1538748K  48896K  bg u0_a71   com.sohu.inputmethod.sogou:classic
 7963  0   0% S    18 1561916K  59568K  fg u0_a58   org.mazhuang.boottimemeasure
 ...
</code></pre>
<p>各列含义：<br>
PID进程 ID<br>
PR优先级<br>
CPU%当前瞬间占用 CPU 百分比<br>
S进程状态（R=运行，S=睡眠，T=跟踪/停止，Z=僵尸进程）<br>
THR 线程数<br>
VSSVirtual Set Size 虚拟耗用内存（包含共享库占用的内存）<br>
RSSResident Set Size 实际使用物理内存（包含共享库占用的内存）<br>
PCY调度策略优先级，SP_BACKGROUND/SPFOREGROUND<br>
UID进程所有者的用户 ID<br>
NAME进程名</p>
<p>top 命令还支持一些命令行参数，详细用法如下：</p>
<pre><code>Usage: top [ -m max_procs ] [ -n iterations ] [ -d delay ] [ -s sort_column ] [ -t ] [ -h ]
    -m num  最多显示多少个进程
    -n num  刷新多少次后退出
    -d num  刷新时间间隔（单位秒，默认值 5）
    -s col  按某列排序（可用 col 值：cpu, vss, rss, thr）
    -t      显示线程信息
    -h      显示帮助文档
</code></pre>
<h3 id="查看进程-uid">查看进程 UID</h3>
<p>有两种方案：</p>
<pre><code>1. adb shell dumpsys package &lt;packagename&gt; | grep userId=
如：
$ adb shell dumpsys package org.mazhuang.guanggoo | grep userId=
   userId=10394
2. 通过 ps 命令找到对应进程的 pid 之后 adb shell cat /proc/&lt;pid&gt;/status | grep Uid
如：
$ adb shell
gemini:/ $ ps | grep org.mazhuang.guanggoo
u0_a394   28635 770   1795812 78736 SyS_epoll_ 0000000000 S org.mazhuang.guanggoo
gemini:/ $ cat /proc/28635/status | grep Uid
Uid:    10394   10394   10394   10394
gemini:/ $
</code></pre>
<p>其它如下是其它常用命令的简单描述，前文已经专门讲过的命令不再额外说明：<br>
cat显示文件内容<br>
cd切换目录<br>
chmod改变文件的存取模式/访问权限<br>
df查看磁盘空间使用情况<br>
grep过滤输出<br>
kill杀死指定 PID 的进程<br>
ls列举目录内容<br>
mount挂载目录的查看和管理<br>
mv移动或重命名文件<br>
ps查看正在运行的进程<br>
rm删除文件<br>
top查看进程的资源占用情况</p>
<h2 id="常见问题">常见问题</h2>
<p>启动 adb server 失败<br>
出错提示<br>
error: protocol fault (couldn't read status): No error<br>
可能原因<br>
adb server 进程想使用的 5037 端口被占用。<br>
解决方案<br>
找到占用 5037 端口的进程，然后终止它。以 Windows 下为例：<br>
netstat -ano | findstr LISTENING<br>
...<br>
TCP    0.0.0.0:5037           0.0.0.0:0              LISTENING       1548<br>
...<br>
这里 1548 即为进程 ID，用命令结束该进程：<br>
taskkill /PID 1548<br>
然后再启动 adb 就没问题了。</p>

                </div>
                <div class="clear"></div>
              </section>
            </article>
            <div class="clear"></div>

            <section class="related section">
              
              
              <article class="next grid-50 tablet-grid-50 grid-parent">
                <div class="thumb cover lazy loaded" style="background-image: url('https://github.com/stepheneasyshot/stepheneasyshot.github.io/post-images/android-ji-cheng-unity-de-liang-chong-fang-an-shi-zhan.jpeg');"></div>
                 <a href="https://github.com/stepheneasyshot/stepheneasyshot.github.io/post/android-ji-cheng-unity-de-liang-chong-fang-an-shi-zhan/" class="full-link"></a>
                 <div class="info">
                  <time datetime="2024-06-06">2024-06-06</time>
                  <h4 class="title white no-margin">Android集成Unity的两种方案实战</h4>
                </div>
                 <span class="epcl-button red">
                  <img src="https://github.com/stepheneasyshot/stepheneasyshot.github.io/media/images/right-arrow.svg" width="15" alt="Left Arrow">
                </span>
                <div class="overlay"></div>
              </article>
              

                <div class="clear"></div>
            </section>

              <div class="clear"></div>
              
            
              <div id="comments" class="bg-white hosted ">
                
                  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>
<div class="clear"></div>

<script>
  var gitalk = new Gitalk({
    clientID: 'Ov23lixgLaEQaGAsum3I',
    clientSecret: '9b93916755a6b8704580aa244f9fab01735829bf',
    repo: 'stephencardev.github.io',
    owner: 'StephenCarDev',
    admin: ['StephenCarDev'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')
</script>

                
                
              </div>
            

            </div>
          </div>
      </main>

          <footer id="footer" class="grid-container">
        <div class="widgets row gradient-effect">
            <div class="default-sidebar border-effect">
              <div class="grid-33 tablet-grid-50 mobile-grid-100">
                <section id="tag_cloud-2" class="widget widget_epcl_posts_thumbs underline-effect">
                  <h4 class="widget-title title white bordered">最新文章</h4>
                  
                  
                  <article class="item post-0 post type-post status-publish format-standard has-post-thumbnail hentry">
                    <a href="https://github.com/stepheneasyshot/stepheneasyshot.github.io/post/android-chang-yong-diao-shi-ming-ling/" class="thumb hover-effect">
                      <span class="fullimage cover" style="display:block;border-radius:50%;background-image: url('https://github.com/stepheneasyshot/stepheneasyshot.github.io/post-images/android-chang-yong-diao-shi-ming-ling.jpg');"></span>
                    </a>
                    <div class="info gradient-effect">
                      <time datetime="2024-06-06">2024-06-06</time>
                      <h4 class="title usmall">
                        <a href="https://github.com/stepheneasyshot/stepheneasyshot.github.io/post/android-chang-yong-diao-shi-ming-ling/">Android常用调试命令</a>
                      </h4>
                    </div>
                    <div class="clear"></div>
                  </article>
                  
                  
                  
                  <article class="item post-1 post type-post status-publish format-standard has-post-thumbnail hentry">
                    <a href="https://github.com/stepheneasyshot/stepheneasyshot.github.io/post/android-ji-cheng-unity-de-liang-chong-fang-an-shi-zhan/" class="thumb hover-effect">
                      <span class="fullimage cover" style="display:block;border-radius:50%;background-image: url('https://github.com/stepheneasyshot/stepheneasyshot.github.io/post-images/android-ji-cheng-unity-de-liang-chong-fang-an-shi-zhan.jpeg');"></span>
                    </a>
                    <div class="info gradient-effect">
                      <time datetime="2024-06-06">2024-06-06</time>
                      <h4 class="title usmall">
                        <a href="https://github.com/stepheneasyshot/stepheneasyshot.github.io/post/android-ji-cheng-unity-de-liang-chong-fang-an-shi-zhan/">Android集成Unity的两种方案实战</a>
                      </h4>
                    </div>
                    <div class="clear"></div>
                  </article>
                  
                  
                  
                  <article class="item post-2 post type-post status-publish format-standard has-post-thumbnail hentry">
                    <a href="https://github.com/stepheneasyshot/stepheneasyshot.github.io/post/android-duo-qu-dao-da-bao-pei-zhi-fang-an/" class="thumb hover-effect">
                      <span class="fullimage cover" style="display:block;border-radius:50%;background-image: url('https://github.com/stepheneasyshot/stepheneasyshot.github.io/post-images/android-duo-qu-dao-da-bao-pei-zhi-fang-an.jpg');"></span>
                    </a>
                    <div class="info gradient-effect">
                      <time datetime="2024-06-05">2024-06-05</time>
                      <h4 class="title usmall">
                        <a href="https://github.com/stepheneasyshot/stepheneasyshot.github.io/post/android-duo-qu-dao-da-bao-pei-zhi-fang-an/">Android多渠道打包配置方案</a>
                      </h4>
                    </div>
                    <div class="clear"></div>
                  </article>
                  
                  
                  
                  
                  
                  
                  
                  
                  <div class="clear"></div>
                </section>
              </div>

              <div class="grid-33 tablet-grid-50 mobile-grid-100">
                <section id="tag_cloud-2" class="widget widget_tag_cloud underline-effect">
                  <h4 class="widget-title title white bordered">标签云</h4>
                  <div class="tagcloud">
                    
                      <a href="https://github.com/stepheneasyshot/stepheneasyshot.github.io/tag/5yQtIxh3Hz/" class="ctag ctag-0 ctag-5yQtIxh3Hz" aria-label="">Android</a>
                    
                      <a href="https://github.com/stepheneasyshot/stepheneasyshot.github.io/tag/4tpluVFZy/" class="ctag ctag-1 ctag-4tpluVFZy" aria-label="">Gridea</a>
                    
                  </div>
                  <div class="clear"></div>
                </section>
              </div>

              <div class="grid-33 tablet-grid-50 mobile-grid-100">
                <section id="epcl_about-2" class="widget widget_epcl_about underline-effect">
                  <h4 class="widget-title title white bordered">关于我</h4>
                  <div class="avatar">
                    <a href="" class="translate-effect thumb"><span class="fullimage cover" style="background-image: url(https://github.com/stepheneasyshot/stepheneasyshot.github.io/images/avatar.png);"></span></a>
                  </div>
                  <div class="info">
                    <h4 class="title small author-name gradient-effect no-margin"><a href="">Stephen&#39;s Personal Page</a></h4>
                    <p class="founder">在行中知，在知中行</p>
                    <div class="social">
                      
                        
                      
                        
                      
                        
                      
                        
                      
                        
                      
                    </div> 
                  </div>
                  <div class="clear"></div>
                  </section>
              </div>

            </div>
            <div class="clear"></div>
        </div>

        <div class="logo">
          <a href="https://github.com/stepheneasyshot/stepheneasyshot.github.io"><img src="/media/images/gridea.png" alt=""></a>
        </div>
        <p class="published border-effect">
          ©2019 共 6 篇文章
          <br/>
          Theme <a href="https://gridea.dev/" target="_blank">「breek」</a> Powered by <a href="https://gridea.dev/" target="_blank">「Gridea」</a>
        </p>
        
        <a href="javascript:void(0)" id="back-to-top" class="epcl-button dark" style="display:none">
          <i class="fa fa-arrow"></i>
        </a>
    </footer>
    
    <div class="clear"></div>

        

      
    <script src="https://github.com/stepheneasyshot/stepheneasyshot.github.io/media/js/functions-post.js"></script>

    </div>
    <!-- end: #wrapper -->
  </body>
</html>
